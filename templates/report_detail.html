{% extends 'base.html' %}
{% block content %}
<h1>Report Details</h1>
<p><strong>Location:</strong> {{ report.location.lat }}, {{ report.location.lng }}</p>
{% for entry in report.entries %}
  <div class="card mb-3">
    <div class="card-body">
      <img src="{{ url_for('main.uploaded_file', filename=entry.image_filename) }}" class="img-fluid mb-2">
      <h5>AI Description</h5>
      <p>{{ entry.ai_description }}</p>
      <h5>AI Advice</h5>
      <p>{{ entry.ai_advice }}</p>
      <h5>Your Description</h5>
      {% if entry.user_description %}
        <p>{{ entry.user_description }}</p>
      {% endif %}
      <form method="post" class="mb-2">
        <input type="hidden" name="entry_id" value="{{ entry.entry_id }}">
        <input type="hidden" name="action" value="update_description">
        <div class="mb-2">
          <textarea class="form-control" name="user_description" rows="2" placeholder="Add your description">{{ entry.user_description }}</textarea>
        </div>
        <button type="submit" class="btn btn-secondary btn-sm">Save Description</button>
      </form>
    </div>
  </div>
{% endfor %}
<h3>Add New Entry</h3>
<form method="post" enctype="multipart/form-data">
  <input type="hidden" name="action" value="add_entry">
  <div class="mb-3">
    <label for="image" class="form-label">Image</label>
    <input class="form-control" type="file" id="image" name="image" required>
  </div>
  <div class="mb-3">
    <label for="user_description_new" class="form-label">Your Description (optional)</label>
    <textarea class="form-control" id="user_description_new" name="user_description" rows="3"></textarea>
  </div>
  <button type="submit" class="btn btn-primary">Add Entry</button>
</form>
{% endblock %}